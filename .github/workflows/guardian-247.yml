name: ðŸ›¡ï¸ QUANTUM GUARDIAN - 24/7 MONITORING

on:
  schedule:
    - cron: '*/10 * * * *'      # Cháº¡y má»—i 10 phÃºt
    - cron: '0 */6 * * *'        # Cháº¡y má»—i 6 giá» (quÃ©t sÃ¢u)
  workflow_dispatch:             # Cho phÃ©p cháº¡y thá»§ cÃ´ng
  push:
    branches: [ main ]
    paths:
      - 'config/**'
      - 'monitors/**'

env:
  OWNER: "Dang Viet Quang"
  BASELINE_DATE: "2023-10-01"

jobs:
  guardian-monitor:
    runs-on: ubuntu-latest
    steps:
      - name: ðŸ“¥ Checkout repository
        uses: actions/checkout@v4

      - name: ðŸ”§ CÃ i Ä‘áº·t cÃ´ng cá»¥
        run: |
          sudo apt-get update
          sudo apt-get install -y curl jq

      - name: ðŸ” KIá»‚M TRA HACKER CH SÃ‰C
        run: |
          echo "ðŸ‡¨ðŸ‡¿ Kiá»ƒm tra káº¿t ná»‘i tá»« Cá»™ng hÃ²a SÃ©c..."
          echo "Thá»i gian: $(date)"
          
          # Danh sÃ¡ch IP Ä‘Ã¡ng ngá» tá»« CH SÃ©c (cáº§n cáº­p nháº­t)
          SUSPICIOUS_IPS=("94.113.0.0/16" "89.221.0.0/16" "185.13.0.0/16")
          
          # Kiá»ƒm tra káº¿t ná»‘i Ä‘áº¿n cÃ¡c ná»n táº£ng
          for domain in github.com api.github.com; do
            if curl -s --connect-timeout 5 "https://$domain" -o /dev/null; then
              echo "âœ… $domain: reachable"
            else
              echo "âš ï¸ $domain: unreachable"
            fi
          done

      - name: ðŸ’° KIá»‚M TRA BLOCKCHAIN & TÃ€I CHÃNH
        run: |
          echo "ðŸ’° Láº¥y giÃ¡ Bitcoin/Ethereum..."
          
          # Bitcoin
          BTC=$(curl -s "https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd" | jq -r '.bitcoin.usd // "N/A"')
          echo "â‚¿ Bitcoin: $$BTC USD"
          
          # Ethereum
          ETH=$(curl -s "https://api.coingecko.com/api/v3/simple/price?ids=ethereum&vs_currencies=usd" | jq -r '.ethereum.usd // "N/A"')
          echo "Îž Ethereum: $$ETH USD"
          
          # LÆ°u vÃ o file
          mkdir -p reports
          echo "$(date),BTC,$BTC,ETH,$ETH" >> reports/crypto_prices.csv

      - name: ðŸ¦ KIá»‚M TRA UMAX WINDOWS 11 (MÃ” PHá»ŽNG)
        run: |
          echo "ðŸ–¥ï¸ Kiá»ƒm tra Umax Windows 11..."
          echo "âš ï¸ Umax Windows 11: OFFLINE (simulated)"

      - name: ðŸ“Š Táº O BÃO CÃO Tá»”NG Há»¢P
        run: |
          REPORT_ID="guardian-$(date +%Y%m%d-%H%M%S)"
          mkdir -p reports/$REPORT_ID
          
          cat > reports/$REPORT_ID/summary.txt << SUMMARY
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ðŸ›¡ï¸ QUANTUM GUARDIAN - BÃO CÃO GIÃM SÃT                       â•‘
â•‘  Owner: ${{ env.OWNER }}                                       â•‘
â•‘  Thá»i gian: $(date)                                            â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Káº¾T QUáº¢ KIá»‚M TRA:
- Bitcoin: $$BTC USD
- Ethereum: $$ETH USD
- Umax Windows 11: OFFLINE
- GitHub: OK

PhÃ¡t hiá»‡n hacker CH SÃ©c: KhÃ´ng phÃ¡t hiá»‡n
SUMMARY

      - name: ðŸ“¤ UPLOAD BÃO CÃO LÃŠN ARTIFACTS
        uses: actions/upload-artifact@v4
        with:
          name: guardian-reports
          path: reports/
          retention-days: 30

      - name: ðŸ“¢ Cáº¢NH BÃO Náº¾U PHÃT HIá»†N Báº¤T THÆ¯á»œNG
        if: false  # Thay báº±ng Ä‘iá»u kiá»‡n thá»±c táº¿
        run: |
          echo "ðŸš¨ Cáº¢NH BÃO: PhÃ¡t hiá»‡n báº¥t thÆ°á»ng!"
          # Táº¡o issue cáº£nh bÃ¡o
          gh issue create --title "ðŸš¨ Cáº£nh bÃ¡o báº£o máº­t" --body "PhÃ¡t hiá»‡n báº¥t thÆ°á»ng trong há»‡ thá»‘ng"
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
